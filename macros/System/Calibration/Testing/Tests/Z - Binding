M291 R"Move Z-Axis" P"Choose an option:" K{"Move Down","Done","Cancel"} S4

M564 H0

if input == 0
    while true
        G1 Z50 F1800
        M291 R"Move Z-Axis" P"Choose an option:" K{"Move more","Done","Cancel"} S4
        if input == 1
            break
        elif input == 2
            abort "Z - Binding test cancelled by user."
elif input == 1
    ; Proceed to next step
elif input == 2
    abort "Z - Binding test cancelled by user."

; Move Z-axis up and down five times
var iter = 0
while var.iter < 5
    G1 Z-20 F1800
    G1 Z20 F1800
    set var.iter = var.iter + 1

M291 R"Was the motion smooth?" P"Choose an option:" K{"Yes","No"} S4

if input == 0
    G1 Z-400 F1800
elif input == 1
    G1 Z-250 F1800
    M291 R"Perform Z - Motor alignment" P" "
    abort "Error: Z - Motor binding reported."

M564 H1